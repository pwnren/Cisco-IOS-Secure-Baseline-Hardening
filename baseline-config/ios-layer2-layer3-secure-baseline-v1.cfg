!
! =====================================================
! DEVICE IDENTITY
! =====================================================
hostname SWITCH-NAME
ip domain-name secure.local
no ip domain-lookup
!
banner motd ^
************************************************************************
*                                                                      *
*  NOTICE TO USERS                                                     *
*                                                                      *
*  This computer system is the private property of the organization.  *
*  It is for authorized use only.                                      *
*                                                                      *
*  Users have no expectation of privacy. All actions may be monitored *
*  and recorded.                                                       *
*                                                                      *
*  Unauthorized access or improper use may result in administrative,  *
*  civil, or criminal penalties.                                       *
*                                                                      *
************************************************************************
^
!
!
! =====================================================
! GLOBAL HARDENING
! =====================================================
no ip http server
no ip http secure-server
no cdp run
no service pad
no ip source-route
no ip bootp server
no ip gratuitous-arps
!
service password-encryption
service timestamps debug datetime msec
service timestamps log datetime msec
!
key config-key password-encrypt <CHANGE_ME_SECURE_KEY>
password encryption aes
!
!
! =====================================================
! AAA / TACACS+
! =====================================================
aaa new-model
aaa authentication login default group tacacs+ local
aaa authorization exec default group tacacs+ local
aaa accounting exec default start-stop group tacacs+
aaa accounting commands 15 default start-stop group tacacs+
!
tacacs server TACACS1
 address ipv4 <X.X.X.X>
 key CHANGE_ME_TACACS_SECRET
!
ip tacacs source-interface <VLAN>
!
username localadmin privilege 15 secret <LOCAL_PASSWORD>
!
!
! =====================================================
! SSH MANAGEMENT PLANE
! =====================================================
crypto key generate rsa modulus 4096
ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 3
!
line con 0
 exec-timeout 10 0
 logging synchronous
 login authentication default
 stopbits 1
!
ip access-list standard MGMT-ACCESS
 permit <MGMT_SUBNET>
 deny any log
!
line vty 0 15
 exec-timeout 10 0
 logging synchronous
 transport preferred none
 transport input ssh
 login authentication default
 access-class MGMT-ACCESS in
!
!
! =====================================================
! SNMPv3 ONLY
! =====================================================
no snmp-server community public
no snmp-server community private
!
snmp-server group SECURE v3 priv
snmp-server user snmpadmin SECURE v3 auth sha AUTH_PASSWORD priv aes 256 PRIV_PASSWORD
snmp-server location SECURE_DATACENTER
snmp-server contact companyemail@domain.com
!
!
! =====================================================
! LOGGING / AUDIT
! =====================================================
logging buffered 16384 warnings
logging trap warnings
logging host <IP>
logging source-interface <IP>
!
archive
 log config
  logging enable
  notify syslog
!
!
! =====================================================
! NTP AUTHENTICATED
! =====================================================
ntp authentication-key <> md5 <NTP>
ntp authenticate
ntp trusted-key <>
ntp server <ip> key <>
ntp source VlanX
!
!
! =====================================================
! LAYER 2 SECURITY
! =====================================================
spanning-tree mode rapid-pvst
spanning-tree portfast default
spanning-tree portfast bpduguard default
spanning-tree vlan 1-4094 priority 61440
!
udld aggressive
!
errdisable recovery cause udld
errdisable recovery cause bpduguard
errdisable recovery cause link-flap
errdisable recovery cause security-violation
errdisable recovery interval 300
!
!
! Access Port Template
!
interface range GigabitEthernet1/0/1-24
 description ACCESS-PORTS
 switchport mode access
 spanning-tree portfast
 spanning-tree bpduguard enable
 storm-control broadcast level 5.00
 switchport port-security
 switchport port-security maximum 2
 switchport port-security violation restrict
 switchport port-security mac-address sticky
!
!
! Root Guard Example (Uplink Toward Distribution)
!
interface GigabitEthernet1/0/48
 description Uplink-to-Distribution
 spanning-tree guard root
!
!
! Loop Guard Example (Core/Distribution Downlink)
!
interface GigabitEthernet1/0/47
 description Downlink-to-Access
 spanning-tree guard loop
!
!
! =====================================================
! ETHERCHANNEL (LACP)
! =====================================================
interface range GigabitEthernet1/0/1-2
 channel-group 1 mode active
!
interface Port-channel1
 description Uplink-to-Core
 switchport mode trunk
 switchport trunk allowed vlan 10,20,35,40,50
 spanning-tree guard root
!
!
! =====================================================
! LAYER 3 (SVI / ROUTING BASE)
! =====================================================
ip routing
!
interface Vlan10
 description ENTERPRISE
 ip address 10.10.10.1 255.255.255.0
!
interface Vlan20
 description OPERATIONS
 ip address 10.10.20.1 255.255.255.0
!
interface Vlan35
 description IDMZ
 ip address 10.10.35.1 255.255.255.192
!
interface Vlan40
 description L2
 ip address 10.10.40.1 255.255.255.224
!
interface Vlan50
 description L1
 ip address 10.10.50.1 255.255.255.240
!
!
! =====================================================
end
write memory
